"use strict";function getProfile(e){$.ajax({type:"get",url:apiDomainURL+"/profiles?filter[email]="+e,headers:{Accept:"application/json"},dataType:"JSON"}).success(function(e){console.log("JSON success response",e),localStorage.setItem("profile_id",e.data[0].id),localStorage.setItem("profile_firstname",e.data[0].attributes.firstname),$("#profile-name").text("Welcome "+e.data[0].attributes.firstname),$("#profile").hide(),toastr.success("Profile linked to "+e.data[0].attributes.firstname,"Success!")}).error(function(e){console.log(e),toastr.error("There was a problem finding the account.")})}function invitePartner(e){$.ajax({type:"post",url:mailDomainURL+"/invite_partner",data:{invite:{email:e,id:localStorage.getItem("profile_id")}},headers:{Accept:"application/json"},dataType:"JSON"}).success(function(t){console.log("JSON success response",t),toastr.info("Invitation successfully sent to "+e+". <br /> Make sure to revisit this page once your partner registers.","Sent!")}).error(function(e){console.log(e),toastr.error("There was a problem finding the account.")})}var apiDomainURL="";apiDomainURL="localhost"===window.location.hostname?"http://localhost:3000":"https://frank.treasury.love";var mailDomainURL="";mailDomainURL="localhost"===window.location.hostname?"http://localhost:3001":"https://frank-mail.treasury.love";var profile_firstname=localStorage.getItem("profile_firstname");if(profile_firstname){var profile_form=$("#profile");profile_form.find('input[name="firstname"]').val(profile_firstname);var linked_profile_email=localStorage.getItem("linked_profile_email");linked_profile_email&&$("#linked-profile-form").find('input[name="email"]').val(linked_profile_email)}$("#profile").submit(function(){var e=$(this).find('input[name="firstname"]').val(),t=$(this).find('input[name="lastname"]').val(),a=$(this).find('input[name="email"]').val(),i='{"data": {"type":"profiles", "attributes":{"firstname":"'+e+'", "lastname":"'+t+'", "email":"'+a+'"}}}';console.log(i),$.ajax({type:$(this).attr("method"),url:apiDomainURL+$(this).attr("action"),data:i,headers:{Accept:"application/json","Content-Type":"application/vnd.api+json"},dataType:"JSON"}).success(function(t){console.log("JSON success response",t),localStorage.setItem("profile_id",t.data.id),localStorage.setItem("profile_firstname",e),$("#profile-name").text("Welcome "+e),$("#profile").hide(),toastr.success("Profile saved.","Success!")}).error(function(e){console.log(e),"422"===e.responseJSON.errors[0].status&&"email - has already been taken"===e.responseJSON.errors[0].detail?getProfile(a):toastr.error("There was a problem saving your account.")}),event.preventDefault()}),$("#linked-profile-form").submit(function(){var e=$(this).find('input[name="email"]').val();$.ajax({type:$(this).attr("method"),url:apiDomainURL+$(this).attr("action")+e,headers:{Accept:"application/json"},dataType:"JSON"}).success(function(t){if(console.log("JSON success response",t),1==t.data.length){var a=t.data[0].id,i=t.data[0].attributes.email;$("#linked-profile-form").hide(),localStorage.setItem("linked_profile_id",a),localStorage.setItem("linked_profile_email",i),toastr.success("Profile linked to "+i,"Success!")}else invitePartner(e),$("#linked-profile-form").trigger("reset")}).error(function(e){console.log(e),toastr.error("There was a problem linking to the account.")}),event.preventDefault()});