"use strict";function getProfile(e){$.ajax({type:"get",url:apiDomainURL+"/profiles?filter[email]="+e,headers:{Accept:"application/json"},dataType:"JSON"}).success(function(e){console.log("JSON success response",e),localStorage.setItem("profile_id",e.data[0].id),localStorage.setItem("profile_firstname",e.data[0].attributes.firstname),$("#profile-name").text("Welcome "+e.data[0].attributes.firstname),$("#profile").hide(),toastr.success("Profile linked.","Success!")}).error(function(e){console.log(e),toastr.error("There was a problem finding the account.")})}var apiDomainURL="";apiDomainURL="localhost"===window.location.hostname?"http://localhost:3000":"https://frank.treasury.love";var profile_firstname=localStorage.getItem("profile_firstname");if(profile_firstname){var profile_form=$("#profile");profile_form.find('input[name="firstname"]').val(profile_firstname);var linked_profile_firstname=localStorage.getItem("linked_profile_firstname");linked_profile_firstname&&$("#linked-profile-form").find('input[name="firstname"]').val(linked_profile_firstname)}$("#profile").submit(function(){var e=$(this).find('input[name="firstname"]').val(),t=$(this).find('input[name="lastname"]').val(),a=$(this).find('input[name="email"]').val(),i='{"data": {"type":"profiles", "attributes":{"firstname":"'+e+'", "lastname":"'+t+'", "email":"'+a+'"}}}';console.log(i),$.ajax({type:$(this).attr("method"),url:apiDomainURL+$(this).attr("action"),data:i,headers:{Accept:"application/json","Content-Type":"application/vnd.api+json"},dataType:"JSON"}).success(function(t){console.log("JSON success response",t),localStorage.setItem("profile_id",t.data.id),localStorage.setItem("profile_firstname",e),$("#profile-name").text("Welcome "+e),$("#profile").hide(),toastr.success("Profile saved.","Success!")}).error(function(e){console.log(e),"422"===e.responseJSON.errors[0].status&&"email - has already been taken"===e.responseJSON.errors[0].detail?getProfile(a):toastr.error("There was a problem saving your account.")}),event.preventDefault()}),$("#linked-profile-form").submit(function(){var e=$(this).find('input[name="email"]').val();$.ajax({type:$(this).attr("method"),url:apiDomainURL+$(this).attr("action")+e,headers:{Accept:"application/json"},dataType:"JSON"}).success(function(e){console.log("JSON success response",e);var t=e.data[0].id,a=e.data[0].attributes.firstname;$("#linked-profile-form").hide(),localStorage.setItem("linked_profile_id",t),localStorage.setItem("linked_profile_firstname",a),toastr.success("Profile linked to "+a,"Success!")}).error(function(e){console.log(e),toastr.error("There was a problem linking to the account.")}),event.preventDefault()});